---
title: "EEB C219B (Ecological Modeling): Final Report"
author: "Kaija Gahm"
date: "2022-08-17"
output: pdf_document
fontsize: 12pt
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# Introduction

## Vultures and mortality by poisoning

Eurasian griffon vultures (*Gyps fulvus,* hereafter "griffons" or "griffon vultures") are obligate scavengers [@ruxton2004] and social foragers [@harel2017]. This means that they feed exclusively on carcasses, and they locate these food sources largely by following other individuals---using social information to locate food is essential in an environment where food sources are both ephemeral and spatiotemporally unpredictable.

However, vultures' tendency to aggregate at carcasses makes them particularly vulnerable to poisoning, usually from carcasses laced with pesticides, illegally deposited by farmers to target predators that threaten their livestock [@bbcnews2019]. Another source of poisoning is non-steroidal anti-inflammatory drugs (NSAIDs), which are often used for veterinary treatment of livestock and can be toxic to vultures [@anglister2022]. Poisoning is a major threat to griffon vulture populations. It is the leading cause of death in the griffon population in Israel, where the species is locally endangered [@anglister2022]. It also threatens vulture species across the world [@ives2022a]. Crucially, because vultures gather to feed at carcasses, poisoned carcasses can kill many individuals within a very short time period. For example, on 2021-10-24 in the southern part of Israel, 13 vultures died in a single poisoning event [@anglister2022a]. In 2019, a mass poisoning in the Golan Heights, in northern Israel, eight vultures were poisoned in one day, with two more transported to a wildlife hospital for treatment after they were found alive at the poisoned carcass site [@bbcnews2019a].

![A Eurasian Griffon Vulture (*Gyps fulvus*) and an Egyptian Vulture (*Neophron percnopterus*) feed at a carcass provided at a feeding site in Israel. Photo by Noa Pinter-Wollman.](images/feedingStationCarcass_pinterWollman.JPG){alt="A Eurasian Griffon Vulture (Gyps fulvus) and an Egyptian Vulture (Neophron percnopterus) feed at a carcass provided at a feeding site in Israel. Photo by Noa Pinter-Wollman."}

## Effects of mortality on social structure

Mortality events such as those caused by poisoning affect not just the raw number of individuals in a population but also the population's social structure---the frequency and patterns of relationships between particular individuals. Social structure affects <!--# thing, ref --> and <!--# thing, ref -->, which are both of conservation concern. Therefore, it is important to understand how mortality might impact these processes.

There has been considerable study in the social network literature of how removing a node affects the network structure <!--# maybe need to introduce the concept of social networks earlier? -->, with a particular focus on how the characteristics of the removed node mediate that effect. This literature has also explored how networks react to sequential removals of multiple nodes; for instance, <!--# REF --> finds that <!--# result having to do with network collapse after a certain point -->. In behavioral ecology, [@shizuka2020] has distinguished between different types of mortality or node removals, arguing that the response of the social network should be different in cases where mortality can be reasonably anticipated by individuals in the population (such as mortality due to sickness or old age) than in cases of unanticipated mortality (e.g. predation or anthropogenic causes like shooting or poisoning). However, the existing literature has not explored the results of the simultaneous loss of several individuals (as opposed to the loss of one individual or sequential loss of several).

## Which individuals die, and does it matter?

Social network analysis of GPS-tagged griffon vultures in Israel lets us study their population social structure. Past work by Nitika Sharma and Noa Pinter-Wollman shows that social networks differ between situations (co-flight, co-feeding, and co-roosting), and that each of these social situations contributes differently to the social network in aggregate [@sharma2022b]. This suggests that changes to relationships in one social situation could affect those in other situations in complicated ways. This is particularly relevant in the case of vulture poisoning because mortality occurs in a specific behavioral situation (co-feeding) but has the potential to affect other situations and the aggregate network. For example, following a poisoning event in the Golan Heights in <!--# YEAR --> when <!--# NUMBER --> of individuals were lost, a previously robust breeding and roosting colony was completely abandoned <!--# I'm not sure this is actually a good example of cross-situation effects... -->.

When modeling the effect of multiple mortality on the network, these social situations are relevant to the selection of which individuals are chosen to die. I expect that mortality of randomly-chosen individuals will affect the network structure differently than the mortality of the same number of individuals clustered on the co-feeding network. <!--# does this part even make sense given that we don't have multiple social situations yet? -->

![From : Social networks across multiple situations. A hypothetical example of social interactions among vultures in different social situations: co-flying in blue, nocturnal ground interactions, (i.e., co-roosting) in green, and diurnal ground interactions (e.g., co-feeding) in yellow. Solid lines within each social situation indicate interactions within the social situation and black-dotted lines between social situations connect occurrences of the same individual. Dashed orange lines connect individuals to food sites to show how spatial proximity can be used to infer social interactions, for example when co-feeding. An aggregate network at the top, in gray, combines all interactions from the different social situations.](images/networkDiagram.png){alt="From : Social networks across multiple situations. A hypothetical example of social interactions among vultures in different social situations: co-flying in blue, nocturnal ground interactions, (i.e., co-roosting) in green, and diurnal ground interactions (e.g., co-feeding) in yellow. Solid lines within each social situation indicate interactions within the social situation and black-dotted lines between social situations connect occurrences of the same individual. Dashed orange lines connect individuals to food sites to show how spatial proximity can be used to infer social interactions, for example when co-feeding. An aggregate network at the top, in gray, combines all interactions from the different social situations."}

## Questions and Hypotheses

In order to investigate the effects of multiple mortality on vulture social networks, I will ask the following questions:

1.  How is the effect of multiple-node loss on network topology mediated by the number and identity of the lost nodes?

2.  How does a social network rewire following the loss of multiple nodes?

# Methods

## Study System: A Vulture Co-Feeding Network

The data that this model is based on comes from a GPS-tagged population of griffon vultures in Israel. The species is locally critically endangered [@efrat2020a] and is managed by the Israel Nature and Parks Authority (INPA), which runs supplemental feeding stations throughout the country [@spiegel2013]. Israel's griffon vultures live mainly in the Negev and Judean deserts in the south. There is a small population in northeastern Israel and a declining population in the northwest. For this analysis, I restricted the data to the southern population, which is relatively well-mixed and somewhat separated from the northern populations.

As part of a collaborative NSF-BSF project between Orr Spiegel and Noa Pinter-Wollman, nearly 100 vultures have been fitted with GPS transmitters over the past two years. These tags provide location information at 10-minute intervals, with data automatically transmitted to Movebank. As of 2022, approximately 70% of the griffon population in Israel is tagged. This high coverage of the population means that the majority of a tagged individual's social interactions are with other tagged individuals, allowing us to study social interactions with greater certainty than is possible in many studies of free-ranging animals.

Despite the extent of this data set, it is not sufficient to directly address questions about the impact of multiple mortality on the vulture social network. While poisoning events pose a severe threat to the vulture population, mass poisonings have occurred only a handful of times during the current study, and in several instances they occurred in regions where relatively smaller proportions of the population were tagged. Therefore, I wanted to create a model that would mimic the baseline dynamics of the real vulture social network, and which I could perturb to test hypotheses about the effect of multiple mortality on the griffon vulture social network.

## Model structure and parameterization

### Baseline

I set out to create an individual-based model that would plausibly capture the day-to-day dynamics of the griffon vulture social network. In the past, the NSF-BSF vulture team has created interaction networks specific to different social situations, defining the network edges in different, biologically meaningful ways for each situation [@sharma2022]. For example, an interaction in the "co-feeding" network is defined as two individuals coming within 50 meters of each other during at least two consecutive 10-minute intervals. My model approximates a co-feeding network, and I have parameterized it based on data from existing co-feeding networks.

The initial network consists of `N` nodes, between which binary edges are randomly assigned with probability `edge.prob`. In each subsequent time step, each edge is assigned as present or absent (0/1) based on its history in the previous two time steps. There are four probability parameters. `add10` and `lose01` are the probabilities, respectively, of adding an edge with history [1, 0] (the edge did not exist in the t-1 network, but did exist in the t-2 network); and of losing an edge with history [0, 1] (the edge existed in the t-1 network but *not* in the t-2 network). `lose11` and `add00` are the probabilities of losing or adding edges with histories 1, 1 and 0, 0, respectively. These probabilities are drawn from beta distributions, each of which is defined by two values (a and b, or 'shape1' and 'shape2' in the `rbeta()` function); thus, `lose11` and `add00` are each vectors of length 2. The value for each edge is drawn from a binomial distribution using `rbinom()`, with the `prob` argument either equal to `lose01` or `add10` or drawn from the beta distribution defined by `add00` or `lose11` . To establish baseline network dynamics, this process of edge assignment continues for a number of time steps specified as `burn.in`. Then, one additional time step is added, from which nodes will be removed in the next phase.

<!--# How was the beta vs. uniform thing determined? -->

### Removal

Next, `n.removed` nodes are removed from the network, along with all of their edges. By default, the removed nodes are chosen randomly, though the model contains an `id` parameter that can be used to optionally specify the identities of `n.removed` particular nodes. Thus, the network at time step `burn.in + 1` contains `N - n.removed` individuals, as will the networks at all subsequent time steps.

### Rewiring

Rewiring is the process of individuals establishing new social connections (or, in a weighted network, strengthening existing ones) following node loss. [@farine2021] describes a pattern of "second-degree rewiring" in a network of songbirds following flockmate loss, whereby individuals with ties to the lost individual are more likely to form new connections with each other than with other individuals.

Since I am interested in determining how the simultaneous loss of multiple individuals affects the structure of the griffon vulture social network, I wanted to be able to test hypotheses about how rewiring proceeds in this system. In other words, how does having been connected to removed individuals affect an individual's tendency to make new connections or retain existing ones? Does second-degree rewiring operate in the griffon vulture system, or do we observe a different pattern?

For each individual remaining in the network after the removal time step, I compute what proportion of its connections in the time step before removal were subsequently removed. This is a coarse measure of how directly affected the focal individual is by the multiple mortality event. For example, if individual A had interacted with B, D, and E, and individuals B and D were lost from the network, then individual A would have a value of 2/3 = 0.66 for its "affectedness". Meanwhile, individual E, which had interacted only with A and C, would not be affected at all (affectedness = 0).

<!--# make a diagram of affectedness here -->

Next, I introduced two parameters into the model, `coefAdd` and `coefLose`. These parameters describe the extent to which an individual's "affectedness" modifies its tendency to form new connections (`coefAdd`) or retain existing ones (`coefLose`). By default, `coefAdd` is set to 1 and `coefLose` is set to -1.

These coefficients are used in conjuction with the affectedness values to modify, for each edge or potential edge, its baseline probabilty of forming. First, I use the "removed" network to compute a baseline probability that each edge will be added or lost in the time step following the removal, taking into account two previous time steps of history as described in [Baseline]. Then, I adjust each edge probability up or down according to the combination of `coefAdd`/`coefLose` and the affectedness of each node.

An example calculation is as follows, for an edge between nodes A and C that has history [1, 0] prior to the removal of nodes B and D from the network, in a model run where `add10` is set to 0.3 and `coefAdd` is set to its default value of 1:

p(add edge A-C) = `add10` + `add10`\*((affectedness~A~ \* `coefAdd`)+(affectedness~C~ \* `coefAdd` ))

p(add edge A-C) = 0.3+0.3\*((0.66\*1)+(0\*1))

p(add edge A-C) = 0.3+0.198

p(add edge A-C) = 0.498

So, node A having lost two of its three connections increases the probability of an edge developing between A and C by 66% in this case. If node C's affectedness had also been 0.66, then the probability for this edge would have increased by 132%, to 0.696. If `coefAdd` were smaller, the increase would be less in either case. Setting `coefAdd` (`coefLose`) to 0 indicates that losing connections does not affect the tendency of a node to form new edges (retain existing edges).

Reversing the signs of `coefAdd` and `coefLose` would produce a scenario in which having lost more connections makes an individual *less*, not more, likely to form any given new edge, and more likely to lose an existing one.

# Results

Discussion
